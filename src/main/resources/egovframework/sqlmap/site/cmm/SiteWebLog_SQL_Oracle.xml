<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="SiteWebLog">
	
	<typeAlias alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap" />
	<typeAlias alias="statVO" type="site.mnt.biz.stat.service.StatVO" />
	
	<insert id="SiteWebLogDAO.insertSiteWebLog" parameterClass="map">
		<![CDATA[
			/* Site 웹로그 등록 */
			INSERT INTO BIZTN_WEB_LOG (
				WEB_LOG_NO
				, ROOT_MENU_NO
				, MENU_NO
				, OCCRRNC_DE
				, RQESTER_ID
				, RQESTER_IP
			) VALUES (		
				(SELECT NVL(MAX(WEB_LOG_NO), 0) + 1 FROM BIZTN_WEB_LOG)
				, #siteUpperMenuNo#
				, #siteMenuNo#
				, SYSDATE
				, #rqesterId#
				, #rqesterIp#
			)				
		]]>
	</insert>
	
	<delete id="SiteWebLogDAO.deleteSiteWebLog">
		<![CDATA[
			/* Site 웹로그 삭제 : 현재일 포함 3일치 로그만 남기고 모두 삭제 */
			DELETE FROM BIZTN_WEB_LOG 
			WHERE TO_CHAR(OCCRRNC_DE, 'YYYY-MM-DD') <= TO_CHAR(SYSDATE - 3, 'YYYY-MM-DD');
		]]>
	</delete>

	<insert id="SiteWebLogDAO.insertSiteVisitrCoSummary">
		<![CDATA[
			/* Site 방문자수 요약 등록 */
			INSERT INTO BIZTS_VISITR_CO_SUMMARY
			(
				ROOT_MENU_NO
				, OCCRRNC_DE
				, RDCNT
			)
			SELECT DISTINCT
				ROOT_MENU_NO
				, TO_CHAR(OCCRRNC_DE, 'YYYY-MM-DD') AS OCCRRNC_DE
				, COUNT(*) OVER(PARTITION BY TO_CHAR(OCCRRNC_DE, 'YYYY-MM-DD'), ROOT_MENU_NO) AS RDCNT
			FROM BIZTN_WEB_LOG A
			WHERE TO_CHAR(OCCRRNC_DE, 'YYYY-MM-DD') < TO_CHAR(SYSDATE, 'YYYY-MM-DD')
				AND NOT EXISTS
				( 
					SELECT 1
					FROM BIZTS_VISITR_CO_SUMMARY B
					WHERE TO_CHAR(B.OCCRRNC_DE, 'YYYY-MM-DD') = TO_CHAR(A.OCCRRNC_DE, 'YYYY-MM-DD')
				 )    				
			GROUP BY TO_CHAR(OCCRRNC_DE, 'YYYY-MM-DD'), ROOT_MENU_NO, RQESTER_IP
		]]>
	</insert>
	
	<insert id="SiteWebLogDAO.insertSitePageviewSummary">
		<![CDATA[
			/* Site 페이지뷰 요약 등록 */
			INSERT INTO BIZTS_PAGEVIEW_SUMMARY
			(
				ROOT_MENU_NO
				, OCCRRNC_DE
				, RDCNT
				, RDCNT_TIME_00
				, RDCNT_TIME_01
				, RDCNT_TIME_02
				, RDCNT_TIME_03
				, RDCNT_TIME_04
				, RDCNT_TIME_05
				, RDCNT_TIME_06
				, RDCNT_TIME_07
				, RDCNT_TIME_08
				, RDCNT_TIME_09
				, RDCNT_TIME_10
				, RDCNT_TIME_11
				, RDCNT_TIME_12
				, RDCNT_TIME_13
				, RDCNT_TIME_14
				, RDCNT_TIME_15
				, RDCNT_TIME_16
				, RDCNT_TIME_17
				, RDCNT_TIME_18
				, RDCNT_TIME_19
				, RDCNT_TIME_20
				, RDCNT_TIME_21
				, RDCNT_TIME_22
				, RDCNT_TIME_23
			)
			SELECT 
				ROOT_MENU_NO
				, TO_CHAR(OCCRRNC_DE, 'YYYY-MM-DD') AS OCCRRNC_DE
				, COUNT(*) AS RDCNT
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '00', 1, 0)) AS RDCNT_TIME_00
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '01', 1, 0)) AS RDCNT_TIME_01
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '02', 1, 0)) AS RDCNT_TIME_02
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '03', 1, 0)) AS RDCNT_TIME_03
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '04', 1, 0)) AS RDCNT_TIME_04
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '05', 1, 0)) AS RDCNT_TIME_05
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '06', 1, 0)) AS RDCNT_TIME_06
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '07', 1, 0)) AS RDCNT_TIME_07
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '08', 1, 0)) AS RDCNT_TIME_08
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '09', 1, 0)) AS RDCNT_TIME_09
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '10', 1, 0)) AS RDCNT_TIME_10
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '11', 1, 0)) AS RDCNT_TIME_11
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '12', 1, 0)) AS RDCNT_TIME_12
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '13', 1, 0)) AS RDCNT_TIME_13
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '14', 1, 0)) AS RDCNT_TIME_14
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '15', 1, 0)) AS RDCNT_TIME_15
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '16', 1, 0)) AS RDCNT_TIME_16
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '17', 1, 0)) AS RDCNT_TIME_17
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '18', 1, 0)) AS RDCNT_TIME_18
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '19', 1, 0)) AS RDCNT_TIME_19
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '20', 1, 0)) AS RDCNT_TIME_20
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '21', 1, 0)) AS RDCNT_TIME_21
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '22', 1, 0)) AS RDCNT_TIME_22
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '23', 1, 0)) AS RDCNT_TIME_23			
			FROM BIZTN_WEB_LOG A
			WHERE TO_CHAR(OCCRRNC_DE, 'YYYY-MM-DD') < TO_CHAR(SYSDATE, 'YYYY-MM-DD')
				AND NOT EXISTS
				( 
					SELECT 1
					FROM BIZTS_PAGEVIEW_SUMMARY B
					WHERE TO_CHAR(B.OCCRRNC_DE, 'YYYY-MM-DD') = TO_CHAR(A.OCCRRNC_DE, 'YYYY-MM-DD')
				 )    		
			GROUP BY TO_CHAR(OCCRRNC_DE, 'YYYY-MM-DD'), ROOT_MENU_NO
		]]>
	</insert>
		
	<insert id="SiteWebLogDAO.insertSiteMenuPageviewSummary">
		<![CDATA[
			/* Site 메뉴페이지뷰 요약 등록 */
			INSERT INTO BIZTS_MENU_PAGEVIEW_SUMMARY
			(
				ROOT_MENU_NO
				, MENU_NO
				, OCCRRNC_DE
				, RDCNT
				, RDCNT_TIME_00
				, RDCNT_TIME_01
				, RDCNT_TIME_02
				, RDCNT_TIME_03
				, RDCNT_TIME_04
				, RDCNT_TIME_05
				, RDCNT_TIME_06
				, RDCNT_TIME_07
				, RDCNT_TIME_08
				, RDCNT_TIME_09
				, RDCNT_TIME_10
				, RDCNT_TIME_11
				, RDCNT_TIME_12
				, RDCNT_TIME_13
				, RDCNT_TIME_14
				, RDCNT_TIME_15
				, RDCNT_TIME_16
				, RDCNT_TIME_17
				, RDCNT_TIME_18
				, RDCNT_TIME_19
				, RDCNT_TIME_20
				, RDCNT_TIME_21
				, RDCNT_TIME_22
				, RDCNT_TIME_23
			)
			SELECT 
				ROOT_MENU_NO
				, MENU_NO
				, TO_CHAR(OCCRRNC_DE, 'YYYY-MM-DD') AS OCCRRNC_DE
				, COUNT(*) AS RDCNT
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '00', 1, 0)) AS RDCNT_TIME_00
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '01', 1, 0)) AS RDCNT_TIME_01
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '02', 1, 0)) AS RDCNT_TIME_02
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '03', 1, 0)) AS RDCNT_TIME_03
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '04', 1, 0)) AS RDCNT_TIME_04
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '05', 1, 0)) AS RDCNT_TIME_05
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '06', 1, 0)) AS RDCNT_TIME_06
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '07', 1, 0)) AS RDCNT_TIME_07
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '08', 1, 0)) AS RDCNT_TIME_08
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '09', 1, 0)) AS RDCNT_TIME_09
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '10', 1, 0)) AS RDCNT_TIME_10
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '11', 1, 0)) AS RDCNT_TIME_11
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '12', 1, 0)) AS RDCNT_TIME_12
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '13', 1, 0)) AS RDCNT_TIME_13
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '14', 1, 0)) AS RDCNT_TIME_14
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '15', 1, 0)) AS RDCNT_TIME_15
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '16', 1, 0)) AS RDCNT_TIME_16
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '17', 1, 0)) AS RDCNT_TIME_17
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '18', 1, 0)) AS RDCNT_TIME_18
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '19', 1, 0)) AS RDCNT_TIME_19
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '20', 1, 0)) AS RDCNT_TIME_20
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '21', 1, 0)) AS RDCNT_TIME_21
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '22', 1, 0)) AS RDCNT_TIME_22
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '23', 1, 0)) AS RDCNT_TIME_23			
			FROM BIZTN_WEB_LOG A
			WHERE TO_CHAR(OCCRRNC_DE, 'YYYY-MM-DD') < TO_CHAR(SYSDATE, 'YYYY-MM-DD')
				AND NOT EXISTS
				( 
					SELECT 1
					FROM BIZTS_MENU_PAGEVIEW_SUMMARY B
					WHERE TO_CHAR(B.OCCRRNC_DE, 'YYYY-MM-DD') = TO_CHAR(A.OCCRRNC_DE, 'YYYY-MM-DD')
				 )    		
			GROUP BY TO_CHAR(OCCRRNC_DE, 'YYYY-MM-DD'), ROOT_MENU_NO, MENU_NO
		]]>
	</insert>
	
	<select id="SiteWebLogDAO.selectSiteVisitrCoTodayList" resultClass="egovMap">
		<![CDATA[	
			/* Site 오늘 방문자수(IP단위) */
			SELECT DISTINCT
				ROOT_MENU_NO
				, (SELECT MENU_NM FROM COMTNMENUINFO WHERE MENU_NO = A.ROOT_MENU_NO) AS ROOT_MENU_NM
				, COUNT(*) OVER(PARTITION BY ROOT_MENU_NO) AS RDCNT
			FROM BIZTN_WEB_LOG A
			WHERE TO_CHAR(OCCRRNC_DE, 'YYYY-MM-DD') = TO_CHAR(SYSDATE, 'YYYY-MM-DD')
			GROUP BY ROOT_MENU_NO, RQESTER_IP	
		]]>		
	</select>
	
	<select id="SiteWebLogDAO.selectSitePageviewTodayList" resultClass="egovMap">
		<![CDATA[		
			/* Site 오늘 전체 페이지뷰 */
			SELECT 
				ROOT_MENU_NO
				, (SELECT MENU_NM FROM COMTNMENUINFO WHERE MENU_NO = A.ROOT_MENU_NO) AS ROOT_MENU_NM
				, COUNT(*) AS RDCNT
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '00', 1, 0)) AS RDCNT_TIME_00
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '01', 1, 0)) AS RDCNT_TIME_01
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '02', 1, 0)) AS RDCNT_TIME_02
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '03', 1, 0)) AS RDCNT_TIME_03
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '04', 1, 0)) AS RDCNT_TIME_04
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '05', 1, 0)) AS RDCNT_TIME_05
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '06', 1, 0)) AS RDCNT_TIME_06
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '07', 1, 0)) AS RDCNT_TIME_07
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '08', 1, 0)) AS RDCNT_TIME_08
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '09', 1, 0)) AS RDCNT_TIME_09
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '10', 1, 0)) AS RDCNT_TIME_10
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '11', 1, 0)) AS RDCNT_TIME_11
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '12', 1, 0)) AS RDCNT_TIME_12
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '13', 1, 0)) AS RDCNT_TIME_13
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '14', 1, 0)) AS RDCNT_TIME_14
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '15', 1, 0)) AS RDCNT_TIME_15
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '16', 1, 0)) AS RDCNT_TIME_16
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '17', 1, 0)) AS RDCNT_TIME_17
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '18', 1, 0)) AS RDCNT_TIME_18
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '19', 1, 0)) AS RDCNT_TIME_19
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '20', 1, 0)) AS RDCNT_TIME_20
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '21', 1, 0)) AS RDCNT_TIME_21
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '22', 1, 0)) AS RDCNT_TIME_22
				, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '23', 1, 0)) AS RDCNT_TIME_23			
			FROM BIZTN_WEB_LOG A
			WHERE TO_CHAR(OCCRRNC_DE, 'YYYY-MM-DD') = TO_CHAR(SYSDATE, 'YYYY-MM-DD')
			GROUP BY ROOT_MENU_NO	
		]]>				
	</select>
	
	<select id="SiteWebLogDAO.selectSiteMenuPageviewTodayList" resultClass="egovMap">
		<![CDATA[		
			/* Site 오늘 메뉴별 페이지뷰 */
			SELECT
				A.MENU_NO
				, A.UPPER_MENU_NO
				, A.MENU_NM
				, LEVEL AS MENU_LEVEL
				, A.MENU_ORDR
				, DECODE(CONNECT_BY_ISLEAF, 0,
				(
					/* 하위 메뉴 페이지뷰 합계 */
					SELECT
						SUM(D.RDCNT)
					FROM COMTNMENUINFO C LEFT OUTER JOIN (
						SELECT 
							MENU_NO
							, COUNT(*) AS RDCNT		
						FROM BIZTN_WEB_LOG
						WHERE TO_CHAR(OCCRRNC_DE, 'YYYY-MM-DD') = TO_CHAR(SYSDATE, 'YYYY-MM-DD')
						GROUP BY ROOT_MENU_NO, MENU_NO
					) D ON C.MENU_NO = D.MENU_NO
					START WITH C.MENU_NO = A.MENU_NO
					CONNECT BY PRIOR C.MENU_NO = C.UPPER_MENU_NO        	    			
				) ) AS TOTAL_RDCNT
				, B.RDCNT
				, B.RDCNT_TIME_00
				, B.RDCNT_TIME_01
				, B.RDCNT_TIME_02
				, B.RDCNT_TIME_03
				, B.RDCNT_TIME_04
				, B.RDCNT_TIME_05
				, B.RDCNT_TIME_06
				, B.RDCNT_TIME_07
				, B.RDCNT_TIME_08
				, B.RDCNT_TIME_09
				, B.RDCNT_TIME_10
				, B.RDCNT_TIME_11
				, B.RDCNT_TIME_12
				, B.RDCNT_TIME_13
				, B.RDCNT_TIME_14
				, B.RDCNT_TIME_15
				, B.RDCNT_TIME_16
				, B.RDCNT_TIME_17
				, B.RDCNT_TIME_18
				, B.RDCNT_TIME_19
				, B.RDCNT_TIME_20
				, B.RDCNT_TIME_21
				, B.RDCNT_TIME_22
				, B.RDCNT_TIME_23
			FROM COMTNMENUINFO A LEFT OUTER JOIN (
				SELECT 
					MENU_NO
					, COUNT(*) AS RDCNT
					, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '00', 1, 0)) AS RDCNT_TIME_00
					, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '01', 1, 0)) AS RDCNT_TIME_01
					, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '02', 1, 0)) AS RDCNT_TIME_02
					, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '03', 1, 0)) AS RDCNT_TIME_03
					, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '04', 1, 0)) AS RDCNT_TIME_04
					, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '05', 1, 0)) AS RDCNT_TIME_05
					, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '06', 1, 0)) AS RDCNT_TIME_06
					, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '07', 1, 0)) AS RDCNT_TIME_07
					, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '08', 1, 0)) AS RDCNT_TIME_08
					, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '09', 1, 0)) AS RDCNT_TIME_09
					, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '10', 1, 0)) AS RDCNT_TIME_10
					, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '11', 1, 0)) AS RDCNT_TIME_11
					, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '12', 1, 0)) AS RDCNT_TIME_12
					, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '13', 1, 0)) AS RDCNT_TIME_13
					, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '14', 1, 0)) AS RDCNT_TIME_14
					, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '15', 1, 0)) AS RDCNT_TIME_15
					, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '16', 1, 0)) AS RDCNT_TIME_16
					, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '17', 1, 0)) AS RDCNT_TIME_17
					, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '18', 1, 0)) AS RDCNT_TIME_18
					, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '19', 1, 0)) AS RDCNT_TIME_19
					, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '20', 1, 0)) AS RDCNT_TIME_20
					, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '21', 1, 0)) AS RDCNT_TIME_21
					, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '22', 1, 0)) AS RDCNT_TIME_22
					, SUM(DECODE(TO_CHAR(OCCRRNC_DE, 'HH24'), '23', 1, 0)) AS RDCNT_TIME_23			
				FROM BIZTN_WEB_LOG
				WHERE TO_CHAR(OCCRRNC_DE, 'YYYY-MM-DD') = TO_CHAR(SYSDATE, 'YYYY-MM-DD')
				GROUP BY ROOT_MENU_NO, MENU_NO
			) B ON A.MENU_NO = B.MENU_NO
			START WITH A.MENU_NO > 0 AND A.UPPER_MENU_NO = 0
			CONNECT BY PRIOR A.MENU_NO = A.UPPER_MENU_NO        	    			
			ORDER SIBLINGS BY A.MENU_ORDR ASC	
		]]>			
	</select>
	
	<select id="SiteWebLogDAO.selectSiteVisitrCoSummaryList" parameterClass="statVO" resultClass="egovMap">
		<![CDATA[		
			/* Site 요약 방문자수 */
			SELECT
				ROOT_MENU_NO
				, (SELECT MENU_NM FROM COMTNMENUINFO WHERE MENU_NO = A.ROOT_MENU_NO) AS ROOT_MENU_NM
				, SUM(RDCNT) AS RDCNT
			FROM BIZTS_VISITR_CO_SUMMARY A
			WHERE 
		]]>								
			<isEqual property="searchCondition" compareValue="0">
				<![CDATA[					
				TO_CHAR(OCCRRNC_DE, 'YYYY-MM-DD') = TO_CHAR(#searchDe#, 'YYYY-MM-DD')
				]]>						
			</isEqual>
			<isEqual property="searchCondition" compareValue="1">
				<![CDATA[					
				TO_CHAR(OCCRRNC_DE, 'YYYY-MM-DD') BETWEEN TO_CHAR(#searchStartDe#, 'YYYY-MM-DD') AND TO_CHAR(#searchEndDe#, 'YYYY-MM-DD')
				]]>					
			</isEqual>
		<![CDATA[				
			GROUP BY ROOT_MENU_NO
		]]>			
	</select>
	
	<select id="SiteWebLogDAO.selectSitePageviewSummaryList" parameterClass="statVO" resultClass="egovMap">
		<![CDATA[			
			/* Site 요약 전체 페이지뷰 */
			SELECT 
				ROOT_MENU_NO
				, (SELECT MENU_NM FROM COMTNMENUINFO WHERE MENU_NO = A.ROOT_MENU_NO) AS ROOT_MENU_NM
				, SUM(RDCNT) AS RDCNT
				, SUM(RDCNT_TIME_00) AS RDCNT_TIME_00
				, SUM(RDCNT_TIME_01) AS RDCNT_TIME_01
				, SUM(RDCNT_TIME_02) AS RDCNT_TIME_02
				, SUM(RDCNT_TIME_03) AS RDCNT_TIME_03
				, SUM(RDCNT_TIME_04) AS RDCNT_TIME_04
				, SUM(RDCNT_TIME_05) AS RDCNT_TIME_05
				, SUM(RDCNT_TIME_06) AS RDCNT_TIME_06
				, SUM(RDCNT_TIME_07) AS RDCNT_TIME_07
				, SUM(RDCNT_TIME_08) AS RDCNT_TIME_08
				, SUM(RDCNT_TIME_09) AS RDCNT_TIME_09
				, SUM(RDCNT_TIME_10) AS RDCNT_TIME_10
				, SUM(RDCNT_TIME_11) AS RDCNT_TIME_11
				, SUM(RDCNT_TIME_12) AS RDCNT_TIME_12
				, SUM(RDCNT_TIME_13) AS RDCNT_TIME_13
				, SUM(RDCNT_TIME_14) AS RDCNT_TIME_14
				, SUM(RDCNT_TIME_15) AS RDCNT_TIME_15
				, SUM(RDCNT_TIME_16) AS RDCNT_TIME_16
				, SUM(RDCNT_TIME_17) AS RDCNT_TIME_17
				, SUM(RDCNT_TIME_18) AS RDCNT_TIME_18
				, SUM(RDCNT_TIME_19) AS RDCNT_TIME_19
				, SUM(RDCNT_TIME_20) AS RDCNT_TIME_20
				, SUM(RDCNT_TIME_21) AS RDCNT_TIME_21
				, SUM(RDCNT_TIME_22) AS RDCNT_TIME_22
				, SUM(RDCNT_TIME_23) AS RDCNT_TIME_23
			FROM BIZTS_PAGEVIEW_SUMMARY A
			WHERE 	
		]]>				
			<isEqual property="searchCondition" compareValue="0">
				<![CDATA[				
				TO_CHAR(OCCRRNC_DE, 'YYYY-MM-DD') = TO_CHAR(#searchDe#, 'YYYY-MM-DD')
				]]>
			</isEqual>
			<isEqual property="searchCondition" compareValue="1">
				<![CDATA[	
				TO_CHAR(OCCRRNC_DE, 'YYYY-MM-DD') BETWEEN TO_CHAR(#searchStartDe#, 'YYYY-MM-DD') AND TO_CHAR(#searchEndDe#, 'YYYY-MM-DD')
				]]>			
			</isEqual>
		<![CDATA[				
			GROUP BY ROOT_MENU_NO
		]]>			
	</select>
	
	<select id="SiteWebLogDAO.selectSiteMenuPageviewSummaryList" parameterClass="statVO" resultClass="egovMap">
		<![CDATA[		
			/* Site 요약 메뉴별 페이지뷰 */
			SELECT
				A.MENU_NO
				, A.UPPER_MENU_NO
				, A.MENU_NM
				, LEVEL AS MENU_LEVEL
				, A.MENU_ORDR
				, DECODE(CONNECT_BY_ISLEAF, 0,
				(
					/* 하위 메뉴 페이지뷰 합계 */
					SELECT
						SUM(D.RDCNT)
					FROM COMTNMENUINFO C LEFT OUTER JOIN (
						SELECT 
							MENU_NO
							, SUM(RDCNT) AS RDCNT
						FROM BIZTS_MENU_PAGEVIEW_SUMMARY
						WHERE 
		]]>								
							<isEqual property="searchCondition" compareValue="0">
								<![CDATA[								
								TO_CHAR(OCCRRNC_DE, 'YYYY-MM-DD') = TO_CHAR(#searchDe#, 'YYYY-MM-DD')
								]]>										
							</isEqual>
							<isEqual property="searchCondition" compareValue="1">
								<![CDATA[	
								TO_CHAR(OCCRRNC_DE, 'YYYY-MM-DD') BETWEEN TO_CHAR(#searchStartDe#, 'YYYY-MM-DD') AND TO_CHAR(#searchEndDe#, 'YYYY-MM-DD')
								]]>									
							</isEqual>
		<![CDATA[								
						GROUP BY ROOT_MENU_NO, MENU_NO	
					) D ON C.MENU_NO = D.MENU_NO
					START WITH C.MENU_NO = A.MENU_NO
					CONNECT BY PRIOR C.MENU_NO = C.UPPER_MENU_NO        	    			
				) ) AS TOTAL_RDCNT
				, B.RDCNT
				, B.RDCNT_TIME_00
				, B.RDCNT_TIME_01
				, B.RDCNT_TIME_02
				, B.RDCNT_TIME_03
				, B.RDCNT_TIME_04
				, B.RDCNT_TIME_05
				, B.RDCNT_TIME_06
				, B.RDCNT_TIME_07
				, B.RDCNT_TIME_08
				, B.RDCNT_TIME_09
				, B.RDCNT_TIME_10
				, B.RDCNT_TIME_11
				, B.RDCNT_TIME_12
				, B.RDCNT_TIME_13
				, B.RDCNT_TIME_14
				, B.RDCNT_TIME_15
				, B.RDCNT_TIME_16
				, B.RDCNT_TIME_17
				, B.RDCNT_TIME_18
				, B.RDCNT_TIME_19
				, B.RDCNT_TIME_20
				, B.RDCNT_TIME_21
				, B.RDCNT_TIME_22
				, B.RDCNT_TIME_23
			FROM COMTNMENUINFO A LEFT OUTER JOIN (
				SELECT 
					MENU_NO
					, SUM(RDCNT) AS RDCNT
					, SUM(RDCNT_TIME_00) AS RDCNT_TIME_00
					, SUM(RDCNT_TIME_01) AS RDCNT_TIME_01
					, SUM(RDCNT_TIME_02) AS RDCNT_TIME_02
					, SUM(RDCNT_TIME_03) AS RDCNT_TIME_03
					, SUM(RDCNT_TIME_04) AS RDCNT_TIME_04
					, SUM(RDCNT_TIME_05) AS RDCNT_TIME_05
					, SUM(RDCNT_TIME_06) AS RDCNT_TIME_06
					, SUM(RDCNT_TIME_07) AS RDCNT_TIME_07
					, SUM(RDCNT_TIME_08) AS RDCNT_TIME_08
					, SUM(RDCNT_TIME_09) AS RDCNT_TIME_09
					, SUM(RDCNT_TIME_10) AS RDCNT_TIME_10
					, SUM(RDCNT_TIME_11) AS RDCNT_TIME_11
					, SUM(RDCNT_TIME_12) AS RDCNT_TIME_12
					, SUM(RDCNT_TIME_13) AS RDCNT_TIME_13
					, SUM(RDCNT_TIME_14) AS RDCNT_TIME_14
					, SUM(RDCNT_TIME_15) AS RDCNT_TIME_15
					, SUM(RDCNT_TIME_16) AS RDCNT_TIME_16
					, SUM(RDCNT_TIME_17) AS RDCNT_TIME_17
					, SUM(RDCNT_TIME_18) AS RDCNT_TIME_18
					, SUM(RDCNT_TIME_19) AS RDCNT_TIME_19
					, SUM(RDCNT_TIME_20) AS RDCNT_TIME_20
					, SUM(RDCNT_TIME_21) AS RDCNT_TIME_21
					, SUM(RDCNT_TIME_22) AS RDCNT_TIME_22
					, SUM(RDCNT_TIME_23) AS RDCNT_TIME_23
				FROM BIZTS_MENU_PAGEVIEW_SUMMARY
				WHERE
		]]>					
				<isEqual property="searchCondition" compareValue="0">
					<![CDATA[					
					TO_CHAR(OCCRRNC_DE, 'YYYY-MM-DD') = TO_CHAR(#searchDe#, 'YYYY-MM-DD')
					]]>	
				</isEqual>
				<isEqual property="searchCondition" compareValue="1">
					<![CDATA[	
					TO_CHAR(OCCRRNC_DE, 'YYYY-MM-DD') BETWEEN TO_CHAR(#searchStartDe#, 'YYYY-MM-DD') AND TO_CHAR(#searchEndDe#, 'YYYY-MM-DD')
					]]>	
				</isEqual>		
		<![CDATA[							
				GROUP BY ROOT_MENU_NO, MENU_NO
			) B ON A.MENU_NO = B.MENU_NO
			START WITH A.MENU_NO > 0 AND A.UPPER_MENU_NO = 0
			CONNECT BY PRIOR A.MENU_NO = A.UPPER_MENU_NO        	    			
			ORDER SIBLINGS BY A.MENU_ORDR ASC
		]]>				
	</select>	
						
</sqlMap>